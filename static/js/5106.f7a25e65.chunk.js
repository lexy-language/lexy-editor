(()=>{"use strict";var e={3458(e,n,t){t.d(n,{Y:()=>r});let r=function(e){return e[e.StartCompilation=0]="StartCompilation",e[e.RunFunction=1]="RunFunction",e}({})},16967(e,n,t){t.d(n,{z:()=>i});t(65043);var r=t(40161),o=t(48574);function a(e){const{getByID:n,addIfNew:t,update:r,deleteAll:o}=e;return{getCodeFile:function(e){return new Promise((t,r)=>n(e).then(e=>t(e?e.code:null)).catch(r))},storeCodeFile:function(e,n,o){return new Promise(o?(t,o)=>{r({id:e,code:n},e).then(e=>t(!0)).catch(o)}:(r,o)=>{t({id:e,code:n},e).then(e=>r(null!=e)).catch(o)})},clearCodeFiles:function(){return o()}}}function i(){return a((0,r.tR)(o.m,"code-files"))}},35106(e,n,t){var r=t(16967);class o{constructor(e){this.currentFolder=void 0,this.store=void 0,this.currentFolder=e,this.store=(0,r.z)()}async readAllLines(e){const n=(this.isPathRooted(e)?e:this.getFullPath(e)).split("/");this.removeFirst(n);const t=await this.store.getCodeFile(n.join("|"));if(!t)throw new Error("Couldn't load: "+e);return t.split("\n")}getFileName(e){return e}getDirectoryName(e){const n=e.split("/");return this.removeLast(n),n.length>0?n.join("/"):""}getFullPath(e){if(this.isPathRooted(e))return e;const n=e.split("/"),t=[...this.currentFolder];for(const r of n)".."===r?this.removeLast(t):t.push(r);return"/"+t.join("/")}removeLast(e){e.splice(e.length-1,1)}removeFirst(e){e.splice(0,1)}combine(e,n){if(0===e.length)return n;const t=e.split("/");0===t[t.length-1].length&&this.removeLast(t);const r=n.split("/");for(const o of r)".."===o?this.removeLast(t):t.push(o);return t.join("/")}async fileExists(e){const n=e.split("/");0===n[0].length&&this.removeFirst(n);return!!await this.store.getCodeFile(n.join("|"))}async directoryExists(e){throw new Error("Not implemented.")}isPathRooted(e){return e.startsWith("/")}async getDirectoryFiles(e,n){return[]}async getDirectories(e){return[]}logFolders(){return""}}var a=t(35284);class i{constructor(){this.loggingValue=[]}get logging(){return this.loggingValue}isEnabled(e){return!0}logDebug(e){this.loggingValue.push({message:e,level:a.LogLevel.Debug})}logError(e){this.loggingValue.push({message:e,level:a.LogLevel.Error})}logInformation(e){this.loggingValue.push({message:e,level:a.LogLevel.Information})}}var s=t(54487),c=t(31632);const l=new class{isEnabled(e){return!1}logDebug(e){}logError(e){}logInformation(e){}};async function u(e,n,t){const r=n.split("\n");return await async function(e,n,t){const r=new Date,o=(0,a.createParser)(l,t,new s.u([])),{componentNodes:i,logger:u,dependencies:d}=await o.parse(n,e,{suppressException:!0}),p=(0,c.milliseconds)(new Date,r).toNumber();return{logging:u.entries,nodes:i,logger:u,elapsed:p,dependencies:d}}(e,r,t)}function d(){return(0,a.createCompiler)(l,l,new s.u([]))}var p=t(52757);function m(e){return e.map(g)}function g(e){return{fileName:e.reference.file.fileName,lineNumber:e.reference.lineNumber,characterNumber:e.reference.characterNumber,sortIndex:e.sortIndex,isError:e.isError,message:e.message}}var y=t(70767),f=t(3458),N=t(77217);function b(e,n){return t=e,r=n,(0,N.A)(+t-+r);var t,r}function v(e){return{message:e.message,readVariables:e.readVariables,writeVariables:e.writeVariables,entries:h(e.entries)}}function h(e){return e.map(v)}function T(e){return e.value}var w=t(15459),E=t(42163),S=t(59849),C=t(51173),F=t(35227);var D=t(57237);function P(e){var n;return{nodeName:e.node?e.node.nodeName:D.s,characterNumber:e.reference?e.reference.characterNumber:D.s,lineNumber:e.reference?e.reference.lineNumber:D.s,fileName:null!==(n=e.reference)&&void 0!==n&&n.file?e.reference.file.fileName:D.s,isError:e.isError,message:e.message,errors:e.errors,executionLogging:e.executionLogging?h(e.executionLogging):D.s}}function x(e){return e.map(P)}var O=t(22697),A=t(38787);const j=globalThis;j.onmessage=async function(e){const{getOperationState:n}=(0,A.Y)();function t(e){j.postMessage(e)}e.data.type===f.Y.StartCompilation?await async function(e){async function r(){let t=await n("compilation-worker"),r=t===e.timestamp;return r||console.log("CANCEL CURRENT OPERATION: ".concat(t," (new: ").concat(e.timestamp,")")),r}try{const n=await async function(e){const n=new o(e.folder),{logging:a,nodes:i,logger:s,elapsed:c,dependencies:l}=await u(e.fileName,e.code,n),d={type:y.y.CompilationCompleted,error:!1,logging:m(a),nodes:(0,p.o6)(i.values),elapsed:c};return await r()?(t(d),{nodes:i,logger:s,elapsed:c,dependencies:l}):null}(e);if(!n)return;const{nodes:s,logger:c,dependencies:l}=n;await async function(e,n,o,s){const c=await async function(e,n,t,r,o){try{const s=d(),c=new i,l=new C.Z(c),u=[];return function(o,i,s){for(const c of n.values){if(c.nodeType!==w.NodeType.Scenario)continue;const l=a.Assert.notNull((0,S.asScenario)(c),"scenario"),u=new E.ScenarioRunner(e,o,n,l,i,r,t);s.push(u)}}(s,l,u),await async function(e){for(const n of e){if(console.log("scenarioRunner: "+n.scenario.name),!await o())return;n.run()}}(u),l.logTimeSpent(),l.logEntries}catch(s){return console.log("scenarioRunner: error "+s),[new F.SpecificationsLogEntry(null,null,!0,"Application error occurred: "+s.stack)]}}(e,n,o,s,r);t({type:y.y.RunScenariosCompleted,result:x(c)})}(e.fileName,s,l,c)}catch(s){t({type:y.y.CompilationFailed,error:!0,lastError:s.stack})}}(e.data):e.data.type===f.Y.RunFunction?await async function(e){const n=new Date;try{var r;const i=new o(e.folder),{nodes:u}=await async function(e,n){const t=new Date,r=(0,a.createParser)(l,n,new s.u([])),{componentNodes:o,logger:i,dependencies:u}=await r.parseFile(e,{suppressException:!0}),d=(0,c.milliseconds)(new Date,t).toNumber();return{logging:i.entries,nodes:o,logger:i,elapsed:d,dependencies:u}}(e.fileName,i),p=function(e){return d().compile(e)}(u.values),m=u.getNode(e.functionName),g=(0,S.instanceOfScenario)(m)?null===(r=(0,S.asScenario)(m))||void 0===r?void 0:r.functionNode:(0,O.asFunction)(m),f=p.getFunction(a.Assert.notNull(g,"functionNode")),N=e.parameters,v=f.run(N),w=b(new Date,n).toNumber();t({type:y.y.RunFunctionCompleted,error:!1,logging:h(v.logging),result:T(v),elapsed:w})}catch(i){t({type:y.y.RunFunctionCompleted,error:!0,lastError:i.stack})}}(e.data):console.log("Invalid compile worker request: "+JSON.stringify(e.data))}},38787(e,n,t){t.d(n,{Y:()=>i});t(65043);var r=t(40161),o=t(48574);function a(e){const{getByID:n,update:t}=e;return{getOperationState:async function(e){const t=await n(e);return null!=t?t.timestamp:null},updateOperationState:async function(e,n){await t({id:e,timestamp:n},e)}}}function i(){return a((0,r.tR)(o.m,"operation-state"))}},40161(e,n,t){t.d(n,{tR:()=>a});const r=globalThis;function o(e,n,t){let o=0;function a(e,n,t){return e?!!function(e,n){return e.objectStoreNames.contains(n)}(e,n)||(t("Store ".concat(n," not found")),!1):(t("Queried before opening connection"),!1)}function i(e,n,t,r,o){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=e.transaction(t,n);return i.onerror=o,i.oncomplete=r,i.onabort=a,i}async function s(){const e=r?r.indexedDB:null;return new Promise((t,r)=>{if(!e)return r("IndexedDB is null");const o=e.open(n.databaseName,n.version);o.onsuccess=()=>{t(o.result)},o.onerror=e=>{r(e.target.error.name)},o.onupgradeneeded=e=>{const t=e.target.result;n.stores.forEach(e=>{if(!t.objectStoreNames.contains(e.name)){const n=t.createObjectStore(e.name,e.id);e.indices.forEach(e=>{n.createIndex(e.name,e.keyPath,e.options)})}})}})}return{add:function(e,n){return new Promise((n,r)=>{s().then(o=>{if(!a(o,t,r))return;let s=i(o,"readwrite",t,e=>console.log("Transaction add completed: "+JSON.stringify(e)),r);s.objectStore(t).add(e).onsuccess=e=>{var t,r;null===s||void 0===s||null===(t=(r=s).commit)||void 0===t||t.call(r),n(e.target.result)}}).catch(r)})},addIfNew:function(e,n){return new Promise((r,o)=>{s().then(s=>{if(!a(s,t,o))return;let c=i(s,"readwrite",t,e=>console.log("Transaction add completed: "+JSON.stringify(e)),o),l=c.objectStore(t);l.get(n).onsuccess=n=>{if(n.target.result)return c.abort(),r(null);l.add(e).onsuccess=e=>{c.commit(),r(e.target.result)}}}).catch(o)})},update:function(e,n){return console.trace(),console.log("Update: ".concat(n,"(").concat(++o,") - ").concat(JSON.stringify(e))),new Promise((r,c)=>{s().then(s=>{if(!a(s,t,c))return;let l=i(s,"readwrite",t,e=>console.log("Transaction update completed: ".concat(n,"(").concat(o,") - ").concat(JSON.stringify(e))),c);l.objectStore(t).put(e).onsuccess=e=>{l.commit(),r(e.target.result)}}).catch(c)})},deleteByID:function(e){return new Promise((n,r)=>{s().then(o=>{if(!a(o,t,r))return;let s=i(o,"readwrite",t,e=>console.log("Transaction deleteByID completed: "+JSON.stringify(e)),r);s.objectStore(t).delete(e).onsuccess=e=>{var t,r;null===s||void 0===s||null===(t=(r=s).commit)||void 0===t||t.call(r),n(e)}}).catch(r)})},deleteAll:function(){return new Promise((e,n)=>{s().then(r=>{if(!a(r,t,n))return;let o=i(r,"readwrite",t,e=>console.log("Transaction deleteAll completed: "+JSON.stringify(e)),n);o.objectStore(t).clear().onsuccess=n=>{var t,r;null===o||void 0===o||null===(t=(r=o).commit)||void 0===t||t.call(r),e(n)}}).catch(n)})},openCursor:function(e,r){return new Promise((o,c)=>{s().then(s=>{if(!a(s,t,c))return;i(s,"readonly",n.databaseName,e=>console.log("Transaction openCursor completed: "+JSON.stringify(e)),c).objectStore(n.databaseName).openCursor(r).onsuccess=n=>{e(n),o()}}).catch(c)})},getByID:function(e){const n=++o;return console.log("getByID: ".concat(e,"(").concat(n,")")),new Promise((r,o)=>{s().then(s=>{if(!a(s,t,o))return;let c=i(s,"readonly",t,e=>console.log("Transaction getByID completed: "+JSON.stringify(e)),o,null).objectStore(t).get(e);c.onsuccess=t=>{console.log("getByID: ".concat(e,"(").concat(n,"): "),t.target.result,"..."),r(t.target.result)},c.onerror=t=>{console.log("getByID: ".concat(e,"(").concat(n,"): error "),t.target.result),o(t.target.result)}}).catch(o)})},getAll:function(){return new Promise((e,n)=>{s().then(r=>{if(!a(r,t,n))return;i(r,"readonly",t,()=>console.log("getAll.validateBeforeTransaction.resolve"),n).objectStore(t).getAll().onsuccess=n=>{e(n.target.result)}}).catch(n)})},getManyByKey:function(e,n){return new Promise((r,o)=>{s().then(s=>{if(!a(s,t,o))return;i(s,"readonly",t,e=>console.log("Transaction getManyByKey completed: "+JSON.stringify(e)),o).objectStore(t).index(e).getAll(n).onsuccess=e=>{r(e.target.result)}}).catch(o)})},getOneByKey:function(e,n){return new Promise((r,o)=>{s().then(s=>{if(!a(s,t,o))return;i(s,"readonly",t,e=>console.log("Transaction getOneByKey completed: "+JSON.stringify(e)),o).objectStore(t).index(e).get(n).onsuccess=e=>{r(e.target.result)}}).catch(o)})}}}function a(e,n){return o(r.indexedDB,e,n)}},48574(e,n,t){t.d(n,{m:()=>r});const r={databaseName:"lexy",version:2,stores:[{name:"operation-state",id:{keyPath:"id",autoIncrement:!1},indices:[]},{name:"code-files",id:{keyPath:"id",autoIncrement:!0},indices:[]}]}},52757(e,n,t){t.d(n,{o6:()=>T});var r=t(89379),o=t(15459),a=t(82140),i=t(27449),s=t(88310),c=t(58996),l=t(35284),u=t(76178),d=t(20429),p=t(18207),m=t(87354),g=t(57237),y=t(92272),f=t(99583),N=t(31200),b=t(85631);let v=function(e){return e.Unknown="Unknown",e.Function="Function",e.Scenario="Scenario",e.Table="Table",e.Type="Type",e.Enum="Enum",e.Code="Code",e.Results="Results",e.Parameters="Parameters",e.EnumMember="EnumMember",e.Errors="Errors",e.Number="Number",e.Boolean="Boolean",e.Date="Date",e.String="String",e.Expression="Expression",e}({}),h=function(e){return e[e.Unsupported=0]="Unsupported",e[e.Primitive=1]="Primitive",e[e.Enum=2]="Enum",e[e.Object=3]="Object",e}({});function T(e){const n={};function t(e){switch(null===e||void 0===e?void 0:e.variableTypeName){case s.VariableTypeName.TableType:return v.Table;case s.VariableTypeName.EnumType:return v.Enum;case s.VariableTypeName.DeclaredType:case s.VariableTypeName.GeneratedType:return v.Type;case s.VariableTypeName.PrimitiveType:return function(){const n=(0,a.asPrimitiveType)(e);switch(null===n||void 0===n?void 0:n.type){case i.TypeNames.number:return v.Number;case i.TypeNames.boolean:return v.Boolean;case i.TypeNames.date:return v.Date;case i.TypeNames.string:return v.String;default:return v.Unknown}}();case s.VariableTypeName.FunctionType:return v.Function;case s.VariableTypeName.VoidType:case g.s:default:return v.Unknown}}function w(e){var t;function r(e,t){if(n[e])return n[e];const r=t();return n[e]=r,r}switch(null===e||void 0===e?void 0:e.variableTypeName){case s.VariableTypeName.PrimitiveType:return function(){let n=l.Assert.notNull((0,a.asPrimitiveType)(e),"asPrimitiveType");return{kind:h.Primitive,name:n.type}}();case s.VariableTypeName.GeneratedType:return function(){let n=l.Assert.notNull((0,y.asGeneratedType)(e),"asGeneratedType");return r(n.name,()=>({kind:h.Object,name:n.name,variables:n.members.map(e=>({name:e.name,type:w(e.type)}))}))}();case s.VariableTypeName.DeclaredType:return function(){let n=l.Assert.notNull((0,f.asDeclaredType)(e),"asDeclaredType");return r(n.type,()=>({kind:h.Object,name:n.type,variables:n.typeDefinition.variables.map(e=>({name:e.name,type:w(e.variableType)}))}))}();case s.VariableTypeName.EnumType:return function(){let n=l.Assert.notNull((0,N.asEnumType)(e),"asGeneratedType");return r(n.type,()=>({kind:h.Enum,name:n.type,members:n.enum.members.map(e=>e.name)}))}();case s.VariableTypeName.FunctionType:case s.VariableTypeName.TableType:default:return{kind:h.Unsupported,name:null!==(t=null===e||void 0===e?void 0:e.variableTypeName)&&void 0!==t?t:"nothing"}}}function E(e){const n=S(e,v.Function),t=function(e){return e.parameters.variables.map(e=>({name:e.name,type:w(e.variableType)}))}(e);return(0,r.A)((0,r.A)({},n),{},{kind:v.Function,parameters:t})}function S(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.s,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=(0,c.asComponentNode)(e),a=o?o.nodeName:"";return{name:null!==t&&void 0!==t?t:a,kind:n,children:r?T(e.getChildren()):[],fileName:e.reference.file.fileName,lineNumber:e.reference.lineNumber,characterNumber:e.reference.characterNumber,nodeType:e.nodeType}}function C(e){switch(e.nodeType){case o.NodeType.FunctionName:case o.NodeType.ScenarioName:case o.NodeType.ScenarioFunctionName:case o.NodeType.EnumName:case o.NodeType.TableRow:return null;case o.NodeType.Function:return E(e);case o.NodeType.Scenario:return S(e,v.Scenario);case o.NodeType.Table:return S(e,v.Table);case o.NodeType.TypeDefinition:return S(e,v.Type);case o.NodeType.EnumDefinition:return S(e,v.Enum);case o.NodeType.FunctionResults:case o.NodeType.ScenarioResults:return S(e,v.Results,"Results");case o.NodeType.FunctionParameters:case o.NodeType.ScenarioParameters:return S(e,v.Parameters,"Parameters");case o.NodeType.FunctionCode:return S(e,v.Code,"Code");case o.NodeType.VariableDefinition:return function(e){const n=l.Assert.notNull((0,u.asVariableDefinition)(e),"variableDefinition"),t=S(e,v.Function,n.name);return(0,r.A)((0,r.A)({},t),{},{kind:v.Function,type:w(n.variableType)})}(e);case o.NodeType.VariableDeclarationExpression:return S(e,t(l.Assert.notNull((0,d.asVariableDeclarationExpression)(e),"variableDeclarationExpression").type.variableType),g.s,!1);case o.NodeType.AssignmentDefinition:{let n=l.Assert.notNull((0,p.asAssignmentDefinition)(e),"variableDefinition");return S(e,t(n.variableType),n.variable.path.join("."),!1)}case o.NodeType.EnumMember:{let n=l.Assert.notNull((0,b.asEnumMember)(e),"enumMember");return S(e,v.EnumMember,n.name,!1)}case o.NodeType.ScenarioExpectErrors:return S(e,v.Errors,"Expect Errors",!0);case o.NodeType.ScenarioExpectComponentErrors:return S(e,v.Errors,"Expect Component Error",!0);case o.NodeType.TableHeader:return S(e,v.Table,"Header",!0);case o.NodeType.ColumnHeader:{var n;const r=l.Assert.notNull((0,m.asColumnHeader)(e),"columnHeader");return S(e,t(null===(n=r.type)||void 0===n?void 0:n.variableType),r.name,!1)}default:return e.nodeType.endsWith("Expression")?S(e,v.Expression,e.nodeType,!0):S(e,v.Unknown,e.nodeType,!0)}}return function(e){const n=new Array;for(const t of e){const e=C(t);null!==e&&n.push(e)}return n}(e)}},57237(e,n,t){t.d(n,{s:()=>r});const r=null},70767(e,n,t){t.d(n,{y:()=>r});let r=function(e){return e[e.CompilationCompleted=0]="CompilationCompleted",e[e.CompilationFailed=1]="CompilationFailed",e[e.RunFunctionCompleted=2]="RunFunctionCompleted",e[e.RunScenariosCompleted=3]="RunScenariosCompleted",e}({})}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return e[r].call(a.exports,a,a.exports,t),a.exports}t.m=e,t.x=()=>{var e=t.O(void 0,[4926],()=>t(35106));return e=t.O(e)},(()=>{var e=[];t.O=(n,r,o,a)=>{if(!r){var i=1/0;for(u=0;u<e.length;u++){for(var[r,o,a]=e[u],s=!0,c=0;c<r.length;c++)(!1&a||i>=a)&&Object.keys(t.O).every(e=>t.O[e](r[c]))?r.splice(c--,1):(s=!1,a<i&&(i=a));if(s){e.splice(u--,1);var l=o();void 0!==l&&(n=l)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[r,o,a]}})(),t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce((n,r)=>(t.f[r](e,n),n),[])),t.u=e=>"static/js/"+e+".4cce981d.chunk.js",t.miniCssF=e=>{},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.p="https://lexy-language.github.io/lexy-editor/",(()=>{var e={5106:1};t.f.i=(n,r)=>{e[n]||importScripts(t.p+t.u(n))};var n=self.webpackChunklexy_editor=self.webpackChunklexy_editor||[],r=n.push.bind(n);n.push=n=>{var[o,a,i]=n;for(var s in a)t.o(a,s)&&(t.m[s]=a[s]);for(i&&i(t);o.length;)e[o.pop()]=1;r(n)}})(),(()=>{var e=t.x;t.x=()=>t.e(4926).then(e)})();t.x()})();
//# sourceMappingURL=5106.f7a25e65.chunk.js.map